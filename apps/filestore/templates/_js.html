{{ storage_used|json_script:"storage_used" }}
<script>
    highlight_navlink();
    add_upload();
    storage_bar();

    function highlight_navlink(){
        let links = document.querySelectorAll('.sidebar__link')
    
        links.forEach(link => link.addEventListener('click', event => {
            links.forEach(link => link.classList.remove('sidebar__link--active'))
            event.currentTarget.classList.add('sidebar__link--active')
        }))
    }

    function add_upload(){
        document.querySelector('#upload-btn').addEventListener('click', () => {
            document.querySelector('#upload-hidden').click();
        })
    }

    function storage_bar(){
        const quota = 1073741824
        const storage_used = document.querySelector('#storage_used').textContent
        const percentage = Math.min((storage_used / quota) * 100, 100);

        const bar = document.querySelector('#progress-bar')
        bar.style.width = `${percentage}%`
        // console.log(bar.style.width)
    }
</script>